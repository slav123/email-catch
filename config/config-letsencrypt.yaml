server:
  ports: [25, 587, 465, 2525]
  hostname: "mail.yourdomain.com"
  tls:
    enabled: true
    # These files will be auto-generated by Let's Encrypt
    cert_file: "certs/letsencrypt/mail.yourdomain.com.crt"
    key_file: "certs/letsencrypt/mail.yourdomain.com.key"
    letsencrypt:
      enabled: true
      domains: ["mail.yourdomain.com"]
      email: "admin@yourdomain.com"
      cache_dir: "certs/letsencrypt"
      staging: false  # Set to true for testing
      http_port: 80   # Port for HTTP-01 challenge
      renew_before_days: 30
  rate_limit:
    enabled: true
    max_emails_per_minute: 1000
    max_email_size_mb: 50

storage:
  s3_compatible:
    enabled: true
    endpoint: "s3.amazonaws.com"  # or your S3-compatible endpoint
    access_key: "${S3_ACCESS_KEY}"
    secret_key: "${S3_SECRET_KEY}"
    bucket: "email-catch-prod"
    region: "us-east-1"
    use_ssl: true
    path_prefix: "emails"
  local:
    enabled: true
    directory: "./emails"

routes:
  - name: "production_capture"
    condition:
      recipient_pattern: ".*@yourdomain.com"
    actions:
      - type: "store_s3"
        enabled: true
        config:
          folder: "production"
      - type: "store_local"
        enabled: true
        config:
          folder: "backup"
    enabled: true

  - name: "support_emails"
    condition:
      recipient_pattern: "support@yourdomain.com"
    actions:
      - type: "store_s3"
        enabled: true
        config:
          folder: "support"
      - type: "webhook"
        enabled: true
        config:
          url: "https://your-api.com/support/new-email"
          method: "POST"
          headers: "Authorization:Bearer ${WEBHOOK_TOKEN}"
    enabled: true

  - name: "billing_emails"
    condition:
      recipient_pattern: "billing@yourdomain.com"
    actions:
      - type: "store_s3"
        enabled: true
        config:
          folder: "billing"
      - type: "webhook"
        enabled: true
        config:
          url: "https://billing-system.com/webhook"
          method: "POST"
    enabled: true

logging:
  level: "info"
  format: "json"
  file: "logs/email-catch.log"